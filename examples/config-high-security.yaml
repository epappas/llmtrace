# High Security Configuration
# Maximum protection for sensitive environments

# Network
listen_addr: "0.0.0.0:8080"
upstream_url: "https://api.openai.com"

# Storage
storage:
  profile: "production"
  postgres_url: "postgresql://llmtrace:password@postgres:5432/llmtrace"
  redis_url: "redis://redis:6379"

# Maximum Security
security:
  enable_prompt_injection_detection: true
  enable_pii_detection: true
  enable_data_leakage_detection: true
  enable_streaming_analysis: true
  
  prompt_injection:
    sensitivity: "maximum"
    block_suspicious_requests: true
    custom_patterns:
      - "ignore.*previous.*instructions"
      - "system.*prompt.*override"
      - "jailbreak|jail break"
      - "bypass.*safety"
      
  pii_detection:
    types: ["email", "phone", "ssn", "credit_card", "passport", "driver_license"]
    redaction_enabled: true
    strict_mode: true
    
  data_leakage:
    detect_credential_exposure: true
    detect_system_prompt_leaks: true
    detect_api_key_exposure: true

# Strict Rate Limiting
rate_limiting:
  enabled: true
  requests_per_minute: 100
  burst_capacity: 200
  per_tenant:
    requests_per_minute: 10

# Conservative Cost Controls
cost_control:
  enabled: true
  daily_budget_usd: 100
  per_agent_daily_budget_usd: 10
  max_prompt_tokens: 2000
  max_completion_tokens: 1000
  blocked_models: ["gpt-4-turbo", "claude-3-opus"]  # Block expensive models

# Immediate Security Alerts
alerts:
  slack:
    enabled: true
    webhook_url: "https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK"
    channel: "#security-alerts"
    mention_users: ["@security-team", "@incident-response"]
  
  security_thresholds:
    prompt_injection: "any"  # Alert on any security finding
    pii_detection: "any"
    data_leakage: "any"

# Audit Logging
logging:
  level: "debug"
  format: "json"
  audit:
    enabled: true
    destination: "syslog://audit.company.com:514"