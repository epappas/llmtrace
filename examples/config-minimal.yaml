# ============================================================================
# LLMTrace — Minimal Configuration
# ============================================================================
#
# The bare minimum to get LLMTrace running with security analysis.
# Good for: local development, quick evaluation, single-developer setups.
#
# Usage:
#   cp examples/config-minimal.yaml config.yaml
#   # Edit upstream_url to point at your LLM provider
#   ./target/release/llmtrace-proxy --config config.yaml
#
# See also:
#   - config-production.yaml     — full production setup
#   - config-high-security.yaml  — maximum security posture
#   - config-cost-control.yaml   — cost management focus
#   - docs/guides/custom-policies.md — comprehensive configuration guide
# ============================================================================

# --- Network ----------------------------------------------------------------

listen_addr: "0.0.0.0:8080"

# Point this at your LLM provider. Examples:
#   OpenAI:    https://api.openai.com
#   Ollama:    http://localhost:11434
#   vLLM:      http://localhost:8000
upstream_url: "https://api.openai.com"

# --- Storage ----------------------------------------------------------------

storage:
  # "lite" = SQLite — zero infrastructure, perfect for getting started
  profile: "lite"
  database_path: "llmtrace.db"
  auto_migrate: true

# --- Logging ----------------------------------------------------------------

logging:
  level: "info"
  format: "text"    # Use "json" if you pipe logs to a collector

# --- Timeouts ---------------------------------------------------------------

timeout_ms: 30000
connection_timeout_ms: 5000
max_connections: 1000

# --- Security ---------------------------------------------------------------

# Enable regex-based security analysis (prompt injection, PII, data leakage)
# This is lightweight and adds <5ms latency per request
enable_security_analysis: true
security_analysis_timeout_ms: 5000

# --- Trace Storage ----------------------------------------------------------

enable_trace_storage: true
trace_storage_timeout_ms: 10000

# --- Streaming --------------------------------------------------------------

enable_streaming: true

# --- Rate Limiting ----------------------------------------------------------

rate_limiting:
  enabled: true
  requests_per_second: 100
  burst_size: 200
  window_seconds: 60

# --- Circuit Breaker --------------------------------------------------------

# Degrades to pass-through if internal systems fail — keeps your app running
circuit_breaker:
  enabled: true
  failure_threshold: 10
  recovery_timeout_ms: 30000
  half_open_max_calls: 3

# --- Cost Estimation --------------------------------------------------------

# Track per-request costs (no enforcement, just visibility)
cost_estimation:
  enabled: true

# --- Health Check -----------------------------------------------------------

health_check:
  enabled: true
  path: "/health"
  interval_seconds: 10
  timeout_ms: 5000
  retries: 3

# --- Graceful Shutdown ------------------------------------------------------

shutdown:
  timeout_seconds: 30
